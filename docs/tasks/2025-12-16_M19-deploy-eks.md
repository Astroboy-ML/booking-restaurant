# Ticket: M19 — Déploiement API sur EKS (manifests + pipeline)

## But
Déployer l’API FastAPI sur le cluster EKS via GitHub Actions en utilisant l’image ECR.

## Scope
- k8s/ (overlays/kustomize prod)
- .github/workflows/ (job de déploiement)
- docs/DEV.md (procédure de déploiement)

## Contraintes
- Image issue de l’ECR (ticket M17) ; namespace dédié.
- Auth EKS via OIDC GitHub Actions (pas de kubeconfig statique commitée).
- Ingress/Service aligné avec l’existant (kind) et sans exposer `/metrics` publiquement.

## Deliverables
- Overlay kustomize/manifest prod pointant vers l’image ECR + namespace + ressources réseau.
- Workflow CI déclenchant kubectl/kustomize apply après push d’image (branch main/tag).
- Documentation des variables nécessaires (cluster name, région, rôle ARN, namespace) et test de santé.

## Critères d’acceptation
- [ ] Le pipeline déploie l’API sur EKS et l’endpoint health répond.
- [ ] L’image utilisée provient d’ECR (tag SHA documenté).
- [ ] Pas de secret en clair ; authentification via OIDC.

## Plan proposé
1) Préparer overlay kustomize prod (namespace, déploiement API, service, ingress).
2) Ajouter le job GitHub Actions pour se connecter à EKS et appliquer les manifests.
3) Documenter le déclencheur, les variables requises et la vérification du healthcheck.
