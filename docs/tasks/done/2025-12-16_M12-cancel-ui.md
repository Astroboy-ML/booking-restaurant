# Ticket: M12 — Espace restaurateur : annuler les réservations (DELETE)

## But
Permettre au restaurateur de consulter et **annuler** (via suppression) les réservations depuis une vue dédiée (gestion du flux MVP côté restaurant).

## Scope
- `apps/web/` (composants/pages restaurateur + client API)
- `docs/DEV.md` (notes d’usage)

## Contraintes
- Réutiliser l’API existante : `DELETE /reservations/{id}` (pas de nouvelle route backend).
- Réutiliser `GET /reservations` pour lister.
- Pas d’auth pour l’instant.
- Confirmation d’action obligatoire (dialogue simple type `window.confirm` accepté).
- Gérer les erreurs API (au minimum 404/500) avec un message utilisateur clair.
- Aucun secret ni URL hardcodée : l’URL backend doit venir de `VITE_API_URL` (via la config centralisée du front).

## Hypothèses / Comportement attendu
- “Annuler” = appeler `DELETE /reservations/{id}`.
- Après annulation, la liste est **rafraîchie via `GET /reservations`** (sans recharger la page).
- Si l’API conserve la réservation avec un champ `status` (ex: `cancelled`), afficher l’état si présent.
  - Si l’API supprime réellement l’entrée, elle disparaît naturellement de la liste.

## Deliverables
- Page “Restaurateur” accessible via `/restaurateur` listant les réservations avec une action **Annuler** par ligne.
- Rafraîchissement automatique de la liste après annulation.
- États UI :
  - Chargement (liste)
  - Action en cours (désactiver le bouton sur la ligne concernée)
  - Erreurs visibles et user-friendly (404 “déjà supprimée/introuvable”, 500 “erreur serveur”, etc.)
- Mise à jour de `docs/DEV.md` (section Front) : comment accéder à l’espace restaurateur + prérequis `VITE_API_URL`.

## Implémentation recommandée
- Ajouter au client API existant `apps/web/src/api/reservations.ts` :
  - `deleteReservation(id: string | number): Promise<void>`
- Réutiliser la page existante de M10 sur `/restaurateur` (ne pas créer une nouvelle route).
- Confirmation : `window.confirm("Annuler cette réservation ?")`.
- Après succès (DELETE 2xx) : recharger la liste via `getReservations()`.
- Après 404 : afficher “Réservation introuvable (déjà supprimée)” + recharger la liste.
- (Optionnel) Tri simple côté front : par `date_time` puis `id`.

## Critères d’acceptation
- [ ] La page `/restaurateur` charge la liste via `GET /reservations` au montage.
- [ ] Cliquer “Annuler” demande confirmation puis appelle `DELETE /reservations/{id}`.
- [ ] Après annulation réussie, la liste est mise à jour sans rechargement de page.
- [ ] Les erreurs API sont affichées à l’utilisateur (au minimum 404 et 500).
- [ ] Aucun secret / URL hardcodée (usage de `VITE_API_URL` via config centralisée).
- [ ] `docs/DEV.md` est mis à jour (accès restaurateur + env + comportement).

## Plan proposé
1) Étendre le client API (`deleteReservation`) et harmoniser la gestion d’erreurs (messages clairs).
2) Implémenter la page restaurateur : liste + bouton Annuler + états (loading/submitting/error) + refresh.
3) Ajouter tests Vitest/RTL (mock `fetch`) :
   - chargement initial de la liste
   - annulation OK (confirm → DELETE → reload)
   - annulation 404/500 (message affiché)
4) Mettre à jour `docs/DEV.md` (URL API, accès à `/restaurateur`, commandes utiles).
