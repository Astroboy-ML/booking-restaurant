# Ticket: M17 — Registry ECR + build/push image API

## But
Provisionner un registry ECR et automatiser le build/push de l’image API pour la future livraison EKS.

## Scope
- infra/terraform/ (ressource ECR)
- .github/workflows/ (job build/push)
- apps/api/Dockerfile (tagging si besoin)
- docs/DEV.md ou README infra

## Contraintes
- Auth GitHub Actions via OIDC (pas de clés statiques) ; tagging avec le SHA Git.
- `terraform plan` ne doit créer que l’ECR (pas d’autres ressources coûteuses).
- Pas de secrets en clair ; variables/ARN documentés.

## Deliverables
- Ressource ECR Terraform + outputs utiles (URL du repo).
- Workflow CI qui build et pousse l’image API vers ECR (branche main/tag).
- Documentation des variables AWS (account, region, rôle OIDC) et du tag de l’image.

## Critères d’acceptation
- [ ] `terraform plan` montre la création d’un repo ECR uniquement.
- [ ] Le workflow CI pousse une image taguée (SHA) dans ECR.
- [ ] Aucun secret statique dans le code ou les workflows.

## Plan proposé
1) Ajouter la ressource ECR et les outputs Terraform nécessaires.
2) Configurer le job GitHub Actions (login ECR OIDC, build, push avec tag SHA).
3) Documenter la configuration attendue (variables, rôle AWS, usage du workflow).
